(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{J0k7:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var a=n("Cfvw"),i=n("cp0P"),o=n("j+be"),r=n("fXoL"),s=n("tk/3"),c=n("OC8m"),l=n("ZtWP");let u=(()=>{class t{constructor(t,e,n){this._http=t,this._notification=e,this.companyService=n}getBaseInfoByRegNum$(t){return Object(a.a)(this._http.get("https://solidexcrm.com/api/v2/egr/getBaseInfoByRegNum/"+t))}getAddressByRegNum$(t){return Object(a.a)(this._http.get("https://solidexcrm.com/api/v2/egr/getAddressByRegNum/"+t))}getJurNamesByRegNum$(t){return Object(a.a)(this._http.get("https://solidexcrm.com/api/v2/egr/getJurNamesByRegNum/"+t))}getVEDByRegNum$(t){return Object(a.a)(this._http.get("https://solidexcrm.com/api/v2/egr/getVEDByRegNum/"+t))}getIPFIOByRegNum$(t){return Object(a.a)(this._http.get("https://solidexcrm.com/api/v2/egr/getIPFIOByRegNum/"+t))}getAllByUnp(t){let e=new o.a;return Object(i.a)([this.getBaseInfoByRegNum$(t),this.getAddressByRegNum$(t),this.getJurNamesByRegNum$(t),this.getVEDByRegNum$(t),this.getIPFIOByRegNum$(t)]).subscribe({next:n=>{if(n.every(t=>null===t))return this._notification.warning("\u0412\u0432\u0435\u0434\u0435\u043d\u043d\u044b\u0439 \u0432\u0430\u043c\u0438 \u0423\u041d\u041f \u043d\u0435 \u0431\u044b\u043b \u043d\u0430\u0439\u0434\u0435\u043d \u0432 \u0431\u0430\u0437\u0435 \u0415\u0413\u0420 \u0438 \u0441\u043a\u043e\u0440\u0435\u0435 \u0432\u0441\u0435\u0433\u043e \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043e\u0448\u0438\u0431\u043e\u0447\u043d\u044b\u043c. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0432\u0432\u043e\u0434\u0430 \u0432\u0441\u0435\u0445 \u0434\u0430\u043d\u043d\u044b\u0445"),void this.companyService.clearCompanyInfo();let a=n[1],i=n[2],o=n[3],r=n[4];e._type=n[0][0].nsi00211.nkvob,e.info=1===e._type?this.mappingJurNames(i[0]):this.mappingIPFIOByRegNum(r[0]),e.juridicalAddress=this.mappingJurAddress(a[0]),e.ved=o[0],e.info.unp=t;const s=this.companyService.getCompany();return e.bankAccount=s.bankAccount,e.mailingAddress=s.mailingAddress,e.person=s.person,this.companyService.setCompany(e),e},error:t=>{switch(t.status){case 400:this._notification.error("\u041f\u043b\u043e\u0445\u043e\u0439 \u0437\u0430\u043f\u0440\u043e\u0441, \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0432\u0432\u043e\u0434\u0438\u043c\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435","\u041f\u043b\u043e\u0445\u043e\u0439 \u0437\u0430\u043f\u0440\u043e\u0441");break;default:this._notification.error(t.error.message,t.error.error)}return null}}),e}mappingJurAddress(t){var e,n;let a=new o.b;return a.city=t.vnp,a.cityType=t.nsi00239.vntnpk,a.country=t.nsi00201.vnstranp,a.houseNumber=t.vdom,a.office=t.vpom,a.officeType=(null===(e=t.nsi00227)||void 0===e?void 0:e.vntpomk)||null,a.street=t.vulitsa,a.streetType=t.nsi00226.vntulk,a.zipCode=t.nindex,a.phone=(null===(n=t.vtels)||void 0===n?void 0:n.replace(/\s/g,""))||null,a.email=t.vemail,a.fax=t.vfax,a.vnsfull=t.nsi00202.vnsfull,a}mappingJurNames(t){let e=new o.c;return e.fullName=t.vnaim,e.shortName=t.vn,e.name=t.vfn,e.fullNameBel=t.vnaimb,e.shortNameBel=t.vnb,e.nameBel=t.vfnb,e.registrationDate=t.dcrta,e}mappingIPFIOByRegNum(t){let e=new o.c;return e.fullName="\u0418\u043d\u0434\u0438\u0432\u0438\u0434\u0443\u0430\u043b\u044c\u043d\u044b\u0439 \u043f\u0440\u0435\u0434\u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u044c "+t.vfio,e.shortName="\u0418\u041f "+t.vfio,e.name="\u0418\u041f "+t.vfio,e.fullNameBel="I\u043d\u0434\u044b\u0432\u0456\u0434\u0443\u0430\u043b\u044c\u043d\u044b \u043f\u0440\u0430\u0434\u043f\u0440\u044b\u043c\u0430\u043b\u044c\u043d\u0456\u043a "+t.vfio,e.shortNameBel="I\u041f "+t.vfio,e.nameBel="I\u041f "+t.vfio,e.registrationDate=t.dcrta,e.unp=t.ngrn,e}}return t.\u0275fac=function(e){return new(e||t)(r["\u0275\u0275inject"](s.a),r["\u0275\u0275inject"](c.a),r["\u0275\u0275inject"](l.a))},t.\u0275prov=r["\u0275\u0275defineInjectable"]({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},ZtWP:function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var a=n("2Vo4"),i=n("Cfvw"),o=n("j+be"),r=n("5UT2"),s=n("fXoL"),c=n("lGQG"),l=n("I/3d"),u=n("OC8m");let p=(()=>{class t{constructor(t,e,n){this.authService=t,this.afs=e,this.notificationService=n,this.company$=new a.a(new o.a),this.dbPath="/companies",this.companyRef=null,this.authService.isLoggedIn&&(this.companyRef=this.afs.collection(this.dbPath,t=>t.where("_userId","==",this.authService.getUserId())))}getAll$(){return this.companyRef.valueChanges()}isCompanyValid(t){return!!t&&this.isCompanyInfoValid(t)&&this.isCompanyBankValid(t)}isCompanyInfoValid(t){return!!t&&Object.values(t.info).every(t=>null!==t)}isCompanyBankValid(t){var e;const n=null===(e=null==t?void 0:t.bankAccount)||void 0===e?void 0:e.bank;let a=!0;return n&&n.CDBank&&n.NmBankShort&&n.CDHeadBank&&n.AdrBank&&"\u0417\u0410\u041a\u0420"!==n.CdControl||(a=!1),a}setCompany(t){t&&this.company$.next(t)}getCompany(){if(this.company$.getValue())return this.company$.getValue();this.setCompany(new o.a)}getProfileCompany$(){return this.afs.collection(this.dbPath,t=>t.where("_userId","==",this.authService.getUserId())).valueChanges()}getCompanyState$(){return this.company$.asObservable()}clearCompanyInfo(){let t=this.getCompany();t.info=new o.c,t.juridicalAddress=new o.b,t.ved=null,t._type=null,this.setCompany(t)}clearCompanyBankAccount(){let t=this.getCompany();t.bankAccount=new r.b,this.setCompany(t)}clearCompanyBank(){let t=this.getCompany();t.bankAccount.bank=new r.a,this.setCompany(t)}clearMailingAddress(){let t=this.getCompany();t.mailingAddress=new o.b,this.setCompany(t)}clearCompany(){this.setCompany(new o.a)}add$(t){return t._id||(t._id=this.afs.createId()),t._userId=this.authService.getUserId(),t._createdDate=(new Date).toString(),Object(i.a)(this.afs.collection(this.dbPath).doc(t._id).set(JSON.parse(JSON.stringify(t))).then(()=>{this.notificationService.success("\u041a\u043e\u043c\u043f\u0430\u043d\u0438\u044f \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430")}))}update$(t,e){return Object(i.a)(this.afs.collection(this.dbPath).doc(t).update(e).then(()=>{this.notificationService.success("\u041a\u043e\u043c\u043f\u0430\u043d\u0438\u044f \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0431\u043d\u0430\u0432\u043b\u0435\u043d\u0430")}))}}return t.\u0275fac=function(e){return new(e||t)(s["\u0275\u0275inject"](c.a),s["\u0275\u0275inject"](l.a),s["\u0275\u0275inject"](u.a))},t.\u0275prov=s["\u0275\u0275defineInjectable"]({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},fu6R:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var a=n("5UT2"),i=n("fXoL"),o=n("tk/3"),r=n("OC8m");let s=(()=>{class t{constructor(t,e){this._http=t,this._notification=e,this.bankInfo=new a.a}getBankByBIC$(t){return this._http.get("https://www.nbrb.by/api/bic?cdbank="+t)}getAllBank$(){return this._http.get("https://www.nbrb.by/api/bic")}}return t.\u0275fac=function(e){return new(e||t)(i["\u0275\u0275inject"](o.a),i["\u0275\u0275inject"](r.a))},t.\u0275prov=i["\u0275\u0275defineInjectable"]({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},n6v2:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var a=n("fXoL"),i=n("ofXK"),o=n("kqZG"),r=n("NEux");function s(t,e){if(1&t){const t=a["\u0275\u0275getCurrentView"]();a["\u0275\u0275elementStart"](0,"div",1),a["\u0275\u0275element"](1,"tui-avatar",2),a["\u0275\u0275elementStart"](2,"div",3),a["\u0275\u0275elementStart"](3,"p",4),a["\u0275\u0275text"](4," \u0411\u0418\u041a \u043d\u043e\u043c\u0435\u0440: "),a["\u0275\u0275elementStart"](5,"b"),a["\u0275\u0275text"](6),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementStart"](7,"h4",5),a["\u0275\u0275text"](8),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementStart"](9,"button",6),a["\u0275\u0275listener"]("click",(function(){return a["\u0275\u0275restoreView"](t),a["\u0275\u0275nextContext"]().change.emit(!0)})),a["\u0275\u0275text"](10," \u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c "),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"]()}if(2&t){const t=a["\u0275\u0275nextContext"]();a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("text",null==t.data?null:t.data.NmBankShort)("autoColor",!0),a["\u0275\u0275advance"](5),a["\u0275\u0275textInterpolate"](null==t.data?null:t.data.CDBank),a["\u0275\u0275advance"](2),a["\u0275\u0275textInterpolate1"](" ",null==t.data?null:t.data.NmBankShort," ")}}let c=(()=>{class t{constructor(){this.change=new a.EventEmitter}ngOnInit(){}ngOnChanges(t){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=a["\u0275\u0275defineComponent"]({type:t,selectors:[["app-bank-panel"]],inputs:{data:"data",isLoaded:"isLoaded"},outputs:{change:"change"},features:[a["\u0275\u0275NgOnChangesFeature"]],decls:1,vars:1,consts:[["class","bank",4,"ngIf"],[1,"bank"],[1,"tui-space_right-3",3,"text","autoColor"],[1,"bank__content"],[1,"bank__subtitle","tui-text_body-s"],[1,"bank__title","tui-text_body-m","tui-space_top-0","tui-space_bottom-0"],["tuiButton","","type","button","appearance","outline","size","m",1,"tui-space_left-3",3,"click"]],template:function(t,e){1&t&&a["\u0275\u0275template"](0,s,11,4,"div",0),2&t&&a["\u0275\u0275property"]("ngIf",e.data)},directives:[i.m,o.a,r.a],styles:[".bank[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;border:1px solid var(--tui-base-04);border-radius:0;padding:15px;margin:0}.bank[_ngcontent-%COMP%]   .bank__content[_ngcontent-%COMP%]{width:100%}.bank[_ngcontent-%COMP%]   .bank__title[_ngcontent-%COMP%]{margin:0;font-weight:600}.bank[_ngcontent-%COMP%]   .bank__subtitle[_ngcontent-%COMP%]{margin:0;font-weight:400;color:var(--tui-text-03)}"]}),t})()},y3l0:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var a=n("fXoL"),i=n("j+be"),o=n("ZtWP"),r=n("ofXK"),s=n("kqZG"),c=n("NEux");function l(t,e){if(1&t){const t=a["\u0275\u0275getCurrentView"]();a["\u0275\u0275elementStart"](0,"div",1),a["\u0275\u0275element"](1,"tui-avatar",2),a["\u0275\u0275elementStart"](2,"div",3),a["\u0275\u0275elementStart"](3,"p",4),a["\u0275\u0275text"](4),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementStart"](5,"h4",5),a["\u0275\u0275text"](6),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementStart"](7,"button",6),a["\u0275\u0275listener"]("click",(function(){return a["\u0275\u0275restoreView"](t),a["\u0275\u0275nextContext"]().change.emit(!0)})),a["\u0275\u0275text"](8," \u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c "),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"]()}if(2&t){const t=a["\u0275\u0275nextContext"]();a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("text",null==t.data||null==t.data.info?null:t.data.info.shortName)("autoColor",!0),a["\u0275\u0275advance"](3),a["\u0275\u0275textInterpolate1"](" \u0423\u041d\u041f: ",(null==t.data||null==t.data.info?null:t.data.info.unp)||"\u043d\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e"," "),a["\u0275\u0275advance"](2),a["\u0275\u0275textInterpolate1"](" ",null==t.data||null==t.data.info?null:t.data.info.shortName," ")}}let u=(()=>{class t{constructor(t){this.companyService=t,this.change=new a.EventEmitter}ngOnInit(){}ngOnChanges(t){t.data&&(new i.a,this.companyService.isCompanyValid(t.data.currentValue))}}return t.\u0275fac=function(e){return new(e||t)(a["\u0275\u0275directiveInject"](o.a))},t.\u0275cmp=a["\u0275\u0275defineComponent"]({type:t,selectors:[["app-company-panel"]],inputs:{data:"data",isLoaded:"isLoaded"},outputs:{change:"change"},features:[a["\u0275\u0275NgOnChangesFeature"]],decls:1,vars:1,consts:[["class","company",4,"ngIf"],[1,"company"],[1,"tui-space_right-3",3,"text","autoColor"],[1,"company__content"],[1,"company__subtitle","tui-text_body-s"],[1,"company__title","tui-text_body-m","tui-space_top-0","tui-space_bottom-0"],["tuiButton","","type","button","appearance","outline","size","m",1,"tui-space_left-3",3,"click"]],template:function(t,e){1&t&&a["\u0275\u0275template"](0,l,9,4,"div",0),2&t&&a["\u0275\u0275property"]("ngIf",e.data&&e.data.info.unp)},directives:[r.m,s.a,c.a],styles:[".company[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;border:1px solid var(--tui-base-04);border-radius:0;padding:15px;margin:0}.company[_ngcontent-%COMP%]   .company__content[_ngcontent-%COMP%]{width:100%}.company[_ngcontent-%COMP%]   .company__title[_ngcontent-%COMP%]{margin:0;font-weight:600}.company[_ngcontent-%COMP%]   .company__subtitle[_ngcontent-%COMP%]{margin:0;font-weight:400;color:var(--tui-text-03)}"]}),t})()},yis4:function(t,e,n){"use strict";n.d(e,"a",(function(){return y}));var a=n("fXoL"),i=n("3Pt+"),o=n("nXPc"),r=n("Ni9E"),s=n("lJxs"),c=n("fu6R"),l=n("q9Vr"),u=n("m1/c"),p=n("ofXK"),m=n("iy9C");function d(t,e){if(1&t){const t=a["\u0275\u0275getCurrentView"]();a["\u0275\u0275elementStart"](0,"button",5),a["\u0275\u0275listener"]("click",(function(){a["\u0275\u0275restoreView"](t);const n=e.$implicit;return a["\u0275\u0275nextContext"](4).select(n)})),a["\u0275\u0275elementStart"](1,"p",6),a["\u0275\u0275text"](2),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementStart"](3,"p",7),a["\u0275\u0275text"](4),a["\u0275\u0275elementEnd"](),a["\u0275\u0275elementEnd"]()}if(2&t){const t=e.$implicit;a["\u0275\u0275property"]("value",t),a["\u0275\u0275advance"](2),a["\u0275\u0275textInterpolate1"](" ",t.NmBankShort," "),a["\u0275\u0275advance"](2),a["\u0275\u0275textInterpolate1"](" ",t.CDBank," ")}}function f(t,e){if(1&t&&(a["\u0275\u0275elementStart"](0,"tui-data-list"),a["\u0275\u0275template"](1,d,5,3,"button",4),a["\u0275\u0275elementEnd"]()),2&t){const t=a["\u0275\u0275nextContext"](2).tuiLet;a["\u0275\u0275advance"](1),a["\u0275\u0275property"]("ngForOf",t)}}function h(t,e){1&t&&(a["\u0275\u0275elementContainerStart"](0),a["\u0275\u0275template"](1,f,2,1,"tui-data-list",3),a["\u0275\u0275elementContainerEnd"]())}function g(t,e){if(1&t&&(a["\u0275\u0275elementStart"](0,"tui-input",1),a["\u0275\u0275text"](1," \u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0431\u0430\u043d\u043a\u0430 \u0438\u043b\u0438 BIC \u043a\u043e\u0434 "),a["\u0275\u0275template"](2,h,2,0,"ng-container",2),a["\u0275\u0275elementEnd"]()),2&t){const t=e.tuiLet,n=a["\u0275\u0275nextContext"]();a["\u0275\u0275property"]("formControl",n.bankControl)("tuiTextfieldCustomContent",n.content),a["\u0275\u0275advance"](2),a["\u0275\u0275property"]("ngIf",null==t?null:t.length)}}let y=(()=>{class t{constructor(t){this.bankService=t,this.change=new a.EventEmitter,this.banks=[],this.bankControl=new i.FormControl(null,i.Validators.required),this.banksSort$=Object(o.f)(this.bankControl).pipe(Object(s.a)(t=>{const e=this.banks.filter(e=>Object(r.i)(e.CDBank,t)||Object(r.i)(e.NmBankShort,t)&&null===e.DtEnd);return 1!==e.length||String(e[0]).toLowerCase()!==t.toLowerCase()?e:(this.select(e[0]),[])})),this.bankService.getAllBank$().subscribe({next:t=>{this.banks=t}})}ngOnInit(){this.banks$=this.getAllBank()}getAllBank(){return this.bankService.getAllBank$()}select(t){this.change.emit(t),this.bankControl.setValue(t.NmBankShort+" ("+t.CDBank+")")}}return t.\u0275fac=function(e){return new(e||t)(a["\u0275\u0275directiveInject"](c.a))},t.\u0275cmp=a["\u0275\u0275defineComponent"]({type:t,selectors:[["app-bank-select"]],outputs:{change:"change"},decls:2,vars:3,consts:[["tuiTextfieldExampleText","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0431\u0430\u043d\u043a\u0430 \u0438\u043b\u0438 \u0435\u0433\u043e BIC",3,"formControl","tuiTextfieldCustomContent",4,"tuiLet"],["tuiTextfieldExampleText","\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0431\u0430\u043d\u043a\u0430 \u0438\u043b\u0438 \u0435\u0433\u043e BIC",3,"formControl","tuiTextfieldCustomContent"],[4,"ngIf"],[4,"tuiDataList"],["tuiOption","","class","banl-item",3,"value","click",4,"ngFor","ngForOf"],["tuiOption","",1,"banl-item",3,"value","click"],[1,"bank-item__title"],[1,"bank-item__bic"]],template:function(t,e){1&t&&(a["\u0275\u0275template"](0,g,3,3,"tui-input",0),a["\u0275\u0275pipe"](1,"async")),2&t&&a["\u0275\u0275property"]("tuiLet",a["\u0275\u0275pipeBind1"](1,1,e.banksSort$))},directives:[l.a,u.a,i.NgControlStatus,i.FormControlDirective,p.m,m.b,m.a,p.l,m.f],pipes:[p.b],styles:[""]}),t})()}}]);